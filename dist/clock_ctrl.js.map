{"version":3,"sources":["../src/clock_ctrl.js"],"names":["randomColorFactory","given_seed","seed","colorDictionary","loadColorBounds","randomColor","options","undefined","parseInt","stringToInteger","TypeError","H","S","B","count","totalColors","colors","length","push","pickHue","pickSaturation","pickBrightness","setFormat","hueRange","getHueRange","hue","randomWithin","luminosity","saturationRange","getSaturationRange","sMin","sMax","bMin","getMinimumBrightness","bMax","hsv","format","HSVtoHSL","hsl","hslColor","alpha","Math","random","HSVtoRGB","rgb","join","rgbColor","HSVtoHex","lowerBounds","getColorInfo","i","s1","v1","s2","v2","m","b","colorInput","number","color","match","HexToHSB","colorName","range","floor","max","min","rnd","componentToHex","c","hex","toString","defineColor","name","brightnessRange","h","s","v","h_i","f","p","q","t","r","g","result","replace","red","substr","green","blue","cMax","delta","saturation","k","round","string","total","Number","MAX_SAFE_INTEGER","charCodeAt","LL","_","moment","MetricsPanelCtrl","appEvents","coords","highlightedMarker","ClockCtrl","$scope","$injector","timeSrv","get","panel","maxDataPoints","dashboard","on","event","timestamp","pos","x","circle","setStyle","fillColor","events","onInitEditMode","bind","onPanelTeardown","render","data","myMap","remove","group_indexes","console","log","groups","ceil","minLat","maxLat","minLon","maxLon","polylines","polyline","forEach","group_index","datapoints","position","Geohash","decode","lat","lng","value","hash","L","map","fitBounds","OpenTopoMap","tileLayer","maxZoom","addTo","weight","opacity","point","circleMarker","stroke","fillOpacity","radius","date","Date","popupContent","toFixed","bindPopup","addEditorTab","$timeout","cancel","nextTickPromise","templateUrl","base32","geohash","bounds","latMin","sw","lonMin","latMax","ne","lonMax","lon","LN10","Error","toLowerCase","evenBit","chr","charAt","idx","indexOf","n","bitN","lonMid","latMid"],"mappings":"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","file":"clock_ctrl.js","sourcesContent":["import LL from './leaflet.js'\nimport _ from 'lodash';\nimport moment from 'moment';\nimport './css/clock-panel.css!';\nimport './leaflet.css!';\nimport {\n  MetricsPanelCtrl\n} from 'app/plugins/sdk';\nimport appEvents from 'app/core/app_events';\n\nvar myMap;\nvar coords = []\nvar highlightedMarker = null\nvar timeSrv\nvar randomColor = randomColorFactory(42);\n\nexport class ClockCtrl extends MetricsPanelCtrl {\n\n  constructor($scope, $injector) {\n    super($scope, $injector);\n\n    timeSrv = $injector.get('timeSrv')\n\n    this.panel.maxDataPoints = 500;\n\n    const dashboard = this.dashboard\n\n    appEvents.on('graph-hover', (event) => {\n      if(coords) {\n        for(var i = 0; i < coords.length; i++) {\n          if(coords[i].timestamp >= event.pos.x) {\n            if(coords[i].circle) {\n              coords[i].circle.setStyle({\n                fillColor: \"red\",\n                color: \"red\"\n              })\n            }\n            if(highlightedMarker) {\n              highlightedMarker.setStyle({\n                fillColor: \"none\",\n                color: \"none\"\n              })\n            }\n            highlightedMarker = coords[i].circle\n            break\n          }\n        }\n      }\n    });\n\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('panel-teardown', this.onPanelTeardown.bind(this));\n    this.events.on('panel-initialized', this.render.bind(this));\n    this.events.on('data-received', function(data) {\n\n        if(myMap) {\n            myMap.remove()\n        }\n\n\n\n\n        var group_indexes = [0];\n        if(data.length == 2) {\n            console.log(\"NO grouping detected\");\n        }else{\n            var groups = Math.ceil(data.length / 2);\n            console.log(\"Grouping detected: \"+groups);\n\n            group_indexes = _.range(0, groups, 2);\n        }\n\n        // Find min/max Lat/Lon to fit viewport to it.\n        var minLat = 90\n        var maxLat = -90\n        var minLon = 180\n        var maxLon = -180\n\n        // Collect coordinates and polylines.\n        coords = []\n      var polylines = []\n      var polyline = []\n      _.forEach(group_indexes, function(group_index) {\n\n            for (var i = 0; i < data[group_index].datapoints.length; i++) {\n\n                const position = data[group_index+1].datapoints[i][0] ? Geohash.decode(data[group_index+1].datapoints[i][0]) : null\n                if (position) {\n                    minLat = Math.min(minLat, position.lat)\n                    minLon = Math.min(minLon, position.lng)\n                    maxLat = Math.max(maxLat, position.lat)\n                    maxLon = Math.max(maxLon, position.lng)\n                    polyline.push(position)\n\n                    coords.push({\n                        value: data[group_index].datapoints[i][0],\n                        hash: data[group_index+1].datapoints[i][0],\n                        position: position,\n                        timestamp: data[group_index].datapoints[i][1]\n                    })\n                }\n            }\n\n            polylines.push(polyline)\n            polyline = []\n        });\n\n\n        // Not needed\n        /*\n      var center = coords.find(point => point.position)\n      center = center ? center.position : [0, 0]\n        */\n\n        // Create map.\n        myMap = L.map('themap')\n\n      // Fix: If there is just one value and max==min which results in a NaN error.\n      if(minLat == maxLat) {\n          minLat -= 0.01;\n          maxLat += 0.01;\n      }\n      if(minLon == maxLon) {\n         minLon -= 0.01;\n         maxLon += 0.01;\n      }\n      myMap.fitBounds([[minLat, minLon], [maxLat, maxLon]])\n\n        // Not needed\n        /*\n      var CartoDB_PositronNoLabels = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> &copy; <a href=\"http://cartodb.com/attributions\">CartoDB</a>',\n        subdomains: 'abcd',\n        maxZoom: 19\n      })\n        */\n\n        // Not needed\n        /*\n      myMap.on(\"boxzoomend\", function(e) {\n        const coordsInBox = coords.filter(coord =>\n          coord.position && e.boxZoomBounds.contains(L.latLng(coord.position.lat, coord.position.lng)))\n        const minTime = Math.min.apply(Math, coordsInBox.map(coord => coord.timestamp))\n        const maxTime = Math.max.apply(Math, coordsInBox.map(coord => coord.timestamp))\n        if (isFinite(minTime) && isFinite(maxTime)) {\n          timeSrv.setTime({\n            from  : moment.utc(minTime),\n            to    : moment.utc(maxTime),\n          })\n        }\n      })\n      */\n\n\n      var OpenTopoMap = L.tileLayer('http://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {\n        maxZoom: 17\n      });\n      OpenTopoMap.addTo(myMap)\n\n\n        // Not needed\n      //var OpenSeaMap = L.tileLayer('http://tiles.openseamap.org/seamark/{z}/{x}/{y}.png', {});\n      //OpenSeaMap.addTo(myMap)\n\n        // Create polylines\n      polylines.forEach(polyline => {\n        L.polyline(polyline, {\n          color: randomColor({luminosity: 'dark'}),\n          weight: 6,\n          opacity: 0.9\n        }).addTo(myMap)\n      })\n\n        // Draw points with popup.\n      coords.forEach(point => {\n        if(point.position) {\n          point.circle = L.circleMarker(point.position, {\n            color: randomColor({luminosity: 'bright'}),\n            stroke: 'false',\n            fillColor: randomColor({luminosity: 'dark'}),\n            fillOpacity: 0.8,\n            radius: 6,\n          });\n\n          var date = new Date(point.timestamp);\n          var popupContent = \"<b>\"+point.value+\"</b><br/>\"\n              +\"Time: \"+date+\"<br/>\"\n              +\"GPS: \"+point.position.lat.toFixed(4)+\", \"+point.position.lng.toFixed(4)+\"<br/>\"\n              +\"Geohash: \"+point.hash;\n\n          point.circle.bindPopup(popupContent, {});\n          point.circle.addTo(myMap)\n        }\n      })\n    });\n\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', 'public/plugins/grafana-clock-panel/editor.html', 2);\n  }\n\n  onPanelTeardown() {\n    this.$timeout.cancel(this.nextTickPromise);\n  }\n\n  // Not used.\n  /*\n  link(scope, elem) {\n    this.events.on('render', () => {\n\n      const $panelContainer = elem.find('.panel-container');\n\n      if(this.panel.bgColor) {\n        $panelContainer.css('background-color', this.panel.bgColor);\n      } else {\n        $panelContainer.css('background-color', '');\n      }\n    });\n  }\n  */\n}\n\nClockCtrl.templateUrl = 'module.html';\n\n\nvar Geohash = {};\n\n/* (Geohash-specific) Base32 map */\nGeohash.base32 = '0123456789bcdefghjkmnpqrstuvwxyz';\n\nGeohash.decode = function(geohash) {\n\n  var bounds = Geohash.bounds(geohash); // <-- the hard work\n  // now just determine the centre of the cell...\n\n  var latMin = bounds.sw.lat,\n    lonMin = bounds.sw.lng;\n  var latMax = bounds.ne.lat,\n    lonMax = bounds.ne.lng;\n\n  // cell centre\n  var lat = (latMin + latMax) / 2;\n  var lon = (lonMin + lonMax) / 2;\n\n  // round to close to centre without excessive precision: ⌊2-log10(Δ°)⌋ decimal places\n  lat = lat.toFixed(Math.floor(2 - Math.log(latMax - latMin) / Math.LN10));\n  lon = lon.toFixed(Math.floor(2 - Math.log(lonMax - lonMin) / Math.LN10));\n\n  return {\n    lat: Number(lat),\n    lng: Number(lon)\n  };\n};\n\nGeohash.bounds = function(geohash) {\n  if(geohash.length === 0) throw new Error('Invalid geohash');\n\n  geohash = geohash.toLowerCase();\n\n  var evenBit = true;\n  var latMin = -90,\n    latMax = 90;\n  var lonMin = -180,\n    lonMax = 180;\n\n  for(var i = 0; i < geohash.length; i++) {\n    var chr = geohash.charAt(i);\n    var idx = Geohash.base32.indexOf(chr);\n    if(idx == -1) throw new Error('Invalid geohash');\n\n    for(var n = 4; n >= 0; n--) {\n      var bitN = idx >> n & 1;\n      if(evenBit) {\n        // longitude\n        var lonMid = (lonMin + lonMax) / 2;\n        if(bitN == 1) {\n          lonMin = lonMid;\n        } else {\n          lonMax = lonMid;\n        }\n      } else {\n        // latitude\n        var latMid = (latMin + latMax) / 2;\n        if(bitN == 1) {\n          latMin = latMid;\n        } else {\n          latMax = latMid;\n        }\n      }\n      evenBit = !evenBit;\n    }\n  }\n\n  var bounds = {\n    sw: {\n      lat: latMin,\n      lng: lonMin\n    },\n    ne: {\n      lat: latMax,\n      lng: lonMax\n    },\n  };\n\n  return bounds;\n};\n\n\nfunction randomColorFactory(given_seed) {\n\n    // Seed to get repeatable colors\n    var seed = given_seed;\n\n    // Shared color dictionary\n    var colorDictionary = {};\n\n    // Populate the color dictionary\n    loadColorBounds();\n\n    var randomColor = function (options) {\n\n        options = options || {};\n\n        // Check if there is a seed and ensure it's an\n        // integer. Otherwise, reset the seed value.\n        if (options.seed !== undefined && options.seed !== null && options.seed === parseInt(options.seed, 10)) {\n            seed = options.seed;\n\n            // A string was passed as a seed\n        } else if (typeof options.seed === 'string') {\n            seed = stringToInteger(options.seed);\n\n            // Something was passed as a seed but it wasn't an integer or string\n        } else if (options.seed !== undefined && options.seed !== null) {\n            throw new TypeError('The seed value must be an integer or string');\n\n            // No seed, reset the value outside.\n        } else {\n            //seed = null;\n        }\n\n        var H,S,B;\n\n        // Check if we need to generate multiple colors\n        if (options.count !== null && options.count !== undefined) {\n\n            var totalColors = options.count,\n                colors = [];\n\n            options.count = null;\n\n            while (totalColors > colors.length) {\n\n                // Since we're generating multiple colors,\n                // incremement the seed. Otherwise we'd just\n                // generate the same color each time...\n                if (seed && options.seed) options.seed += 1;\n\n                colors.push(randomColor(options));\n            }\n\n            options.count = totalColors;\n\n            return colors;\n        }\n\n        // First we pick a hue (H)\n        H = pickHue(options);\n\n        // Then use H to determine saturation (S)\n        S = pickSaturation(H, options);\n\n        // Then use S and H to determine brightness (B).\n        B = pickBrightness(H, S, options);\n\n        // Then we return the HSB color in the desired format\n        return setFormat([H,S,B], options);\n    };\n\n    function pickHue (options) {\n\n        var hueRange = getHueRange(options.hue),\n            hue = randomWithin(hueRange);\n\n        // Instead of storing red as two seperate ranges,\n        // we group them, using negative numbers\n        if (hue < 0) {hue = 360 + hue;}\n\n        return hue;\n\n    }\n\n    function pickSaturation (hue, options) {\n\n        if (options.hue === 'monochrome') {\n            return 0;\n        }\n\n        if (options.luminosity === 'random') {\n            return randomWithin([0,100]);\n        }\n\n        var saturationRange = getSaturationRange(hue);\n\n        var sMin = saturationRange[0],\n            sMax = saturationRange[1];\n\n        switch (options.luminosity) {\n\n            case 'bright':\n                sMin = 55;\n                break;\n\n            case 'dark':\n                sMin = sMax - 10;\n                break;\n\n            case 'light':\n                sMax = 55;\n                break;\n        }\n\n        return randomWithin([sMin, sMax]);\n\n    }\n\n    function pickBrightness (H, S, options) {\n\n        var bMin = getMinimumBrightness(H, S),\n            bMax = 100;\n\n        switch (options.luminosity) {\n\n            case 'dark':\n                bMax = bMin + 20;\n                break;\n\n            case 'light':\n                bMin = (bMax + bMin)/2;\n                break;\n\n            case 'random':\n                bMin = 0;\n                bMax = 100;\n                break;\n        }\n\n        return randomWithin([bMin, bMax]);\n    }\n\n    function setFormat (hsv, options) {\n\n        switch (options.format) {\n\n            case 'hsvArray':\n                return hsv;\n\n            case 'hslArray':\n                return HSVtoHSL(hsv);\n\n            case 'hsl':\n                var hsl = HSVtoHSL(hsv);\n                return 'hsl('+hsl[0]+', '+hsl[1]+'%, '+hsl[2]+'%)';\n\n            case 'hsla':\n                var hslColor = HSVtoHSL(hsv);\n                var alpha = options.alpha || Math.random();\n                return 'hsla('+hslColor[0]+', '+hslColor[1]+'%, '+hslColor[2]+'%, ' + alpha + ')';\n\n            case 'rgbArray':\n                return HSVtoRGB(hsv);\n\n            case 'rgb':\n                var rgb = HSVtoRGB(hsv);\n                return 'rgb(' + rgb.join(', ') + ')';\n\n            case 'rgba':\n                var rgbColor = HSVtoRGB(hsv);\n                var alpha = options.alpha || Math.random();\n                return 'rgba(' + rgbColor.join(', ') + ', ' + alpha + ')';\n\n            default:\n                return HSVtoHex(hsv);\n        }\n\n    }\n\n    function getMinimumBrightness(H, S) {\n\n        var lowerBounds = getColorInfo(H).lowerBounds;\n\n        for (var i = 0; i < lowerBounds.length - 1; i++) {\n\n            var s1 = lowerBounds[i][0],\n                v1 = lowerBounds[i][1];\n\n            var s2 = lowerBounds[i+1][0],\n                v2 = lowerBounds[i+1][1];\n\n            if (S >= s1 && S <= s2) {\n\n                var m = (v2 - v1)/(s2 - s1),\n                    b = v1 - m*s1;\n\n                return m*S + b;\n            }\n\n        }\n\n        return 0;\n    }\n\n    function getHueRange (colorInput) {\n\n        if (typeof parseInt(colorInput) === 'number') {\n\n            var number = parseInt(colorInput);\n\n            if (number < 360 && number > 0) {\n                return [number, number];\n            }\n\n        }\n\n        if (typeof colorInput === 'string') {\n\n            if (colorDictionary[colorInput]) {\n                var color = colorDictionary[colorInput];\n                if (color.hueRange) {return color.hueRange;}\n            } else if (colorInput.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)) {\n                var hue = HexToHSB(colorInput)[0];\n                return [ hue, hue ];\n            }\n        }\n\n        return [0,360];\n\n    }\n\n    function getSaturationRange (hue) {\n        return getColorInfo(hue).saturationRange;\n    }\n\n    function getColorInfo (hue) {\n\n        // Maps red colors to make picking hue easier\n        if (hue >= 334 && hue <= 360) {\n            hue-= 360;\n        }\n\n        for (var colorName in colorDictionary) {\n            var color = colorDictionary[colorName];\n            if (color.hueRange &&\n                hue >= color.hueRange[0] &&\n                hue <= color.hueRange[1]) {\n                return colorDictionary[colorName];\n            }\n        } return 'Color not found';\n    }\n\n    function randomWithin (range) {\n        if (seed === null) {\n            return Math.floor(range[0] + Math.random()*(range[1] + 1 - range[0]));\n        } else {\n            //Seeded random algorithm from http://indiegamr.com/generate-repeatable-random-numbers-in-js/\n            var max = range[1] || 1;\n            var min = range[0] || 0;\n            seed = (seed * 9301 + 49297) % 233280;\n            var rnd = seed / 233280.0;\n            return Math.floor(min + rnd * (max - min));\n        }\n    }\n\n    function HSVtoHex (hsv){\n\n        var rgb = HSVtoRGB(hsv);\n\n        function componentToHex(c) {\n            var hex = c.toString(16);\n            return hex.length == 1 ? '0' + hex : hex;\n        }\n\n        var hex = '#' + componentToHex(rgb[0]) + componentToHex(rgb[1]) + componentToHex(rgb[2]);\n\n        return hex;\n\n    }\n\n    function defineColor (name, hueRange, lowerBounds) {\n\n        var sMin = lowerBounds[0][0],\n            sMax = lowerBounds[lowerBounds.length - 1][0],\n\n            bMin = lowerBounds[lowerBounds.length - 1][1],\n            bMax = lowerBounds[0][1];\n\n        colorDictionary[name] = {\n            hueRange: hueRange,\n            lowerBounds: lowerBounds,\n            saturationRange: [sMin, sMax],\n            brightnessRange: [bMin, bMax]\n        };\n\n    }\n\n    function loadColorBounds () {\n\n        defineColor(\n            'monochrome',\n            null,\n            [[0,0],[100,0]]\n        );\n\n        defineColor(\n            'red',\n            [-26,18],\n            [[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]\n        );\n\n        defineColor(\n            'orange',\n            [19,46],\n            [[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]\n        );\n\n        defineColor(\n            'yellow',\n            [47,62],\n            [[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]\n        );\n\n        defineColor(\n            'green',\n            [63,178],\n            [[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]\n        );\n\n        defineColor(\n            'blue',\n            [179, 257],\n            [[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]\n        );\n\n        defineColor(\n            'purple',\n            [258, 282],\n            [[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]\n        );\n\n        defineColor(\n            'pink',\n            [283, 334],\n            [[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]\n        );\n\n    }\n\n    function HSVtoRGB (hsv) {\n\n        // this doesn't work for the values of 0 and 360\n        // here's the hacky fix\n        var h = hsv[0];\n        if (h === 0) {h = 1;}\n        if (h === 360) {h = 359;}\n\n        // Rebase the h,s,v values\n        h = h/360;\n        var s = hsv[1]/100,\n            v = hsv[2]/100;\n\n        var h_i = Math.floor(h*6),\n            f = h * 6 - h_i,\n            p = v * (1 - s),\n            q = v * (1 - f*s),\n            t = v * (1 - (1 - f)*s),\n            r = 256,\n            g = 256,\n            b = 256;\n\n        switch(h_i) {\n            case 0: r = v; g = t; b = p;  break;\n            case 1: r = q; g = v; b = p;  break;\n            case 2: r = p; g = v; b = t;  break;\n            case 3: r = p; g = q; b = v;  break;\n            case 4: r = t; g = p; b = v;  break;\n            case 5: r = v; g = p; b = q;  break;\n        }\n\n        var result = [Math.floor(r*255), Math.floor(g*255), Math.floor(b*255)];\n        return result;\n    }\n\n    function HexToHSB (hex) {\n        hex = hex.replace(/^#/, '');\n        hex = hex.length === 3 ? hex.replace(/(.)/g, '$1$1') : hex;\n\n        var red = parseInt(hex.substr(0, 2), 16) / 255,\n            green = parseInt(hex.substr(2, 2), 16) / 255,\n            blue = parseInt(hex.substr(4, 2), 16) / 255;\n\n        var cMax = Math.max(red, green, blue),\n            delta = cMax - Math.min(red, green, blue),\n            saturation = cMax ? (delta / cMax) : 0;\n\n        switch (cMax) {\n            case red: return [ 60 * (((green - blue) / delta) % 6) || 0, saturation, cMax ];\n            case green: return [ 60 * (((blue - red) / delta) + 2) || 0, saturation, cMax ];\n            case blue: return [ 60 * (((red - green) / delta) + 4) || 0, saturation, cMax ];\n        }\n    }\n\n    function HSVtoHSL (hsv) {\n        var h = hsv[0],\n            s = hsv[1]/100,\n            v = hsv[2]/100,\n            k = (2-s)*v;\n\n        return [\n            h,\n            Math.round(s*v / (k<1 ? k : 2-k) * 10000) / 100,\n            k/2 * 100\n        ];\n    }\n\n    function stringToInteger (string) {\n        var total = 0\n        for (var i = 0; i !== string.length; i++) {\n            if (total >= Number.MAX_SAFE_INTEGER) break;\n            total += string.charCodeAt(i)\n        }\n        return total\n    }\n\n    return randomColor;\n};\n"]}